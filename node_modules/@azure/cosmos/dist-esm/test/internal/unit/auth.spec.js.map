{"version":3,"file":"auth.spec.js","sourceRoot":"","sources":["../../../../test/internal/unit/auth.spec.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC,OAAO,EAAE,wCAAwC,EAAE,MAAM,mBAAmB,CAAC;AAE7E,OAAO,MAAM,MAAM,QAAQ,CAAC;AAE5B,QAAQ,CAAC,mBAAmB,EAAE;IAC5B,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI,KAAK,CAAC,CAAC;IAEjD,EAAE,CAAC,yBAAyB,EAAE,KAAK;QACjC,MAAM,KAAK,GAAG,wCAAwC,CACpD;YACE,GAAG,EAAE,KAAK;SACX,EACD,KAAK,EACL,KAAK,CACN,CAAC;QACF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;IACnC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK;QAC5C,MAAM,KAAK,GAAG,wCAAwC,CACpD;YACE,iFAAiF,EAAE,OAAO;SAC3F,EACD,qGAAqG,EACrG,gGAAgG,CACjG,CAAC;QACF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IACrC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { getAuthorizationTokenUsingResourceTokens } from \"../../../src/auth\";\nimport { Suite } from \"mocha\";\nimport assert from \"assert\";\n\ndescribe(\"NodeJS CRUD Tests\", function(this: Suite) {\n  this.timeout(process.env.MOCHA_TIMEOUT || 10000);\n\n  it(\"should find exact match\", async function() {\n    const token = getAuthorizationTokenUsingResourceTokens(\n      {\n        foo: \"bar\"\n      },\n      \"foo\",\n      \"foo\"\n    );\n    assert.strictEqual(token, \"bar\");\n  });\n\n  it(\"should only allow container tokens\", async function() {\n    const token = getAuthorizationTokenUsingResourceTokens(\n      {\n        \"dbs/ValidateAuthorization containe8734/colls/ValidateAuthorization containe5344\": \"token\"\n      },\n      \"/dbs/ValidateAuthorization%20containe8734/colls/ValidateAuthorization%20containe5344/docs/coll1doc1\",\n      \"dbs/ValidateAuthorization containe8734/colls/ValidateAuthorization containe5344/docs/coll1doc1\"\n    );\n    assert.strictEqual(token, \"token\");\n  });\n});\n"]}